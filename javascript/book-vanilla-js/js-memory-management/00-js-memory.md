# JavaScript - 메모리 관리

> [바닐라 자바스크립트 - 고승원 (비제이퍼블릭)](http://www.yes24.com/Product/Goods/105608999) 도서를 읽고 학습한 내용을 정리한 내용입니다.

---

## 자바스크립트 메모리 관리

- 자바스크립트는 객체 생성 시점에 자동으로 메모리를 할당.
- 가비지 콜렉션을 통해 쓸모가 없다고 판단되는 것은 자동으로 메모리를 해제
- 할당된 메모리를 사용하는 것은 명시적이지만 메모리 할당과 해제는 암묵적으로 일어난다.

> 저수준 언어인 C언어 등은 메모리를 직접 할당하고 해제한다. malloc(), free() 등을 사용

### 메모리 할당

- 값을 선언할 때 자동으로 메모리를 할당한다.
- 함수 호출을 통해 함수의 결과로써 메모리가 할당되기도 한다.

#### 메모리 구분

- 스택 메모리 (stack)
  - 원시 타입 값들을 저장하는 단순 변수들
  - String, Number, Boolean, Null, Undefined, Synbol, Bigint 등
- 힙 메모리 (heap)
  - 참조형 데이터에 대한 참조값을 저장
  - 객체형 데이터가 해당된다.
  - 동적으로 크기가 변할 수 있는 데이터들이 해당된다.(객체, 배열, Map, Set 등)
  - null 을 할당 시 메모리를 수동으로 해제할 수 있다.


### 메모리 해제

- 자바스크립트에서는 메모리 해제가 가비지 컬렌션에 의해 자동으로 해제된다.

#### 가비지 컬렉션

- Garbage Collection
- 메모리 관리 기법 중 하나로 할당했던 메모리 영역 중에서 사용이 필요없게 된 영역을 해제하는 기능을 말한다.
- 가비지 콜렉터마다 구현된 알고리즘에 따라 작동하는 방식에 차이가 있다.
  - 레퍼런스 카운팅
    - 객체를 참조하는 변수의 수를 관리
  - 마크 앤 스윕
    - roots 를 기준으로 참조하는 오브젝트들을 표시하며, 표시되지 않는 오브젝트들은 컬렉션 대상이 되어 메모리가 반환된다.

> 객체의 참조와 관련되어 자동으로 처리된다고 이해. 아주 기본적인 내용만 정리... 찾아보니 자바스크립트의 메모리 누수와 관련하여 심화적인 내용도 많다.(전역 변수 관리, 잘못된 클로저 사용 등등) 추후 더 학습 후에 따로 다루기 📝

---

## 정리

- 일반적으로 자바스크립크는 메모리를 자동으로 할당하고 해제한다.
- 메모리 해제와 관련하여 가비지 컬렉션에 대해 알고 있어야 한다.
  - 가비지 컬렉션이 자동으로 메모리를 해제하여 관리.
  - 프로그램의 로직이나 상황에 따라 가비지 컬렉션이 감지하지 못하는 메모리 누수가 발생할 수도 있음을 주의할 것.

---

**참고 자료**

- [MDN - 자바스크립트의 메모리 관리](https://developer.mozilla.org/ko/docs/Web/JavaScript/Memory_Management)
- [Toast ui - 당신이 모르는 자바스크립트의 메모리 누수의 비밀](https://ui.toast.com/weekly-pick/ko_20210611)